<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adminbereich – Kinder-Ferien-Club</title>
<style>
body { font-family: Arial; background:#f2f2f2; margin:0; padding:20px;}
.container { max-width:1000px; margin:auto; background:#fff; padding:25px; border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,0.1);}
h1 { text-align:center; color:#0060b8;}
input[type="text"] { width:100%; padding:8px; margin:10px 0; border-radius:5px; border:1px solid #ccc;}
table { width:100%; border-collapse:collapse; margin-top:15px;}
th, td { border:1px solid #ccc; padding:8px; text-align:left; }
th { background:#f0f0f0;}
img.signatur { max-width:150px; max-height:80px; border:1px solid #ccc; border-radius:4px;}
.export-btn { margin:5px 0; padding:8px 12px; background:#cc0000; color:white; border:none; border-radius:5px; cursor:pointer;}
.export-btn:hover { background:#aa0000;}
</style>
</head>
<body>
<div class="container">
<h1>Adminbereich – Kinder-Ferien-Club</h1>

<label for="search">Suche nach Vorname, Nachname oder ID:</label>
<input type="text" id="search" placeholder="Suche...">

<div id="export-buttons">
<!-- 12 Export Buttons -->
{% for i in range(1,13) %}
<form style="display:inline;" action="/export_excel" method="get">
    <input type="hidden" name="pw" value="{{ request.args.get('pw') }}">
    <button type="submit" class="export-btn">Export {{i}}</button>
</form>
{% endfor %}
</div>

<table id="registration-table">
<thead>
<tr>
<th>ID</th><th>Vorname</th><th>Nachname</th><th>Email</th><th>Straße</th><th>PLZ</th><th>Ort</th><th>Geburtsdatum</th><th>Notfallnummer</th><th>Allergien</th><th>Signatur</th><th>DSGVO</th>
</tr>
</thead>
<tbody>
{% for r in registrations %}
<tr>
<td>{{ r.get('ID','') }}</td>
<td>{{ r.get('Vorname','') }}</td>
<td>{{ r.get('Nachname','') }}</td>
<td>{{ r.get('Email','') }}</td>
<td>{{ r.get('Strasse','') }}</td>
<td>{{ r.get('PLZ','') }}</td>
<td>{{ r.get('Ort','') }}</td>
<td>{{ r.get('Geburtsdatum','') }}</td>
<td>{{ r.get('Notfallnummer','') }}</td>
<td>{{ r.get('Allergien','') }}</td>
<td>
{% if r.get('Unterschrift') %}
<img class="signatur" src="{{ r.get('Unterschrift') }}" alt="Signatur">
{% else %}-{% endif %}
</td>
<td>{{ 'Ja' if r.get('DSGVO') else 'Nein' }}</td>
</tr>
{% endfor %}
</tbody>
</table>
</div>

<script>
const searchInput = document.getElementById("search");
searchInput.addEventListener("input", function(){
    const filter = this.value.toLowerCase();
    const rows = document.querySelectorAll("#registration-table tbody tr");
    rows.forEach(row=>{
        const cells = row.querySelectorAll("td");
        const text = cells[0].innerText.toLowerCase()+" "+
                     cells[1].innerText.toLowerCase()+" "+
                     cells[2].innerText.toLowerCase();
        row.style.display = text.includes(filter) ? "" : "none";
    });
});
</script>
</body>
</html>
