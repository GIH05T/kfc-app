<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kinder-Ferien-Club Steinen – Online-Anmeldung 2026</title>
<link rel="stylesheet" href="/static/style.css">
</head>
<body>
<div class="container">
    <img src="/static/icon-kfc.png" class="logo" alt="Ferienclub Logo">
    <h1>Kinder-Ferien-Club Steinen</h1>
    <h2>Online-Anmeldung 2026</h2>

    <form id="registration-form" action="/" method="POST">

        <label>Geschlecht<span class="required">*</span></label>
        <select name="Geschlecht" required>
            <option value="">Bitte wählen</option>
            <option value="m">männlich</option>
            <option value="w">weiblich</option>
        </select>

        <label>Vorname<span class="required">*</span></label>
        <input type="text" id="Vorname" name="Vorname" placeholder="Max" required>

        <label>Nachname<span class="required">*</span></label>
        <input type="text" id="Nachname" name="Nachname" placeholder="Mustermann" required>

        <label>E-Mail (freiwillig)</label>
        <input type="email" id="email" name="Email" placeholder="max@beispiel.de">

        <label>Straße<span class="required">*</span></label>
        <input type="text" id="strasse" name="Strasse" placeholder="Musterstraße 12" required>

        <label>Postleitzahl<span class="required">*</span></label>
        <input type="text" id="plz" name="PLZ" placeholder="79665" required>

        <label>Ort<span class="required">*</span></label>
        <input type="text" id="ort" name="Ort" placeholder="Steinen" required>

        <label>Geburtsdatum<span class="required">*</span></label>
        <input type="date" id="geburtsdatum" name="Geburtsdatum" required>

        <label>Notfalltelefonnummer<span class="required">*</span></label>
        <input type="tel" id="notfallnummer" name="Notfallnummer" placeholder="01234 567890" required>

        <label>Allergien (freiwillig)</label>
        <select id="allergien" name="Allergien">
            <option value="">-- Keine Angabe --</option>
            <option value="keine">Keine</option>
            <option value="nüsse">Nüsse</option>
            <option value="laktose">Laktose</option>
            <option value="ei">Ei</option>
            <option value="gluten">Gluten</option>
        </select>

        <label>Unterschrift<span class="required">*</span></label>
        <canvas id="signature-pad"></canvas>
        <button type="button" class="reset-btn" id="reset-btn">Signatur löschen</button>
        <input type="hidden" id="signature" name="Unterschrift" required>

        <div class="checkbox-container">
            <input type="checkbox" id="dsgvo" name="DSGVO" required>
            <label for="dsgvo">Ich stimme der <a href="/datenschutz" target="_blank">Datenschutzerklärung</a> zu <span class="required">*</span></label>
        </div>

        <button type="submit" id="submit-btn" disabled>Jetzt anmelden</button>
    </form>
</div>

<script>
// --- Signatur Pad & Button aktiv ---
const canvas = document.getElementById("signature-pad");
const ctx = canvas.getContext("2d");
const hiddenInput = document.getElementById("signature");
const resetBtn = document.getElementById("reset-btn");
const submitBtn = document.getElementById("submit-btn");

function resizeCanvas() {
    const style = getComputedStyle(canvas);
    canvas.width = parseInt(style.width);
    canvas.height = parseInt(style.height);
    ctx.lineWidth = 2;
    ctx.lineCap = "round";
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

let drawing = false;
let lastX = 0;
let lastY = 0;

canvas.addEventListener("mousedown", e => { drawing=true; [lastX,lastY]=[e.offsetX,e.offsetY]; });
canvas.addEventListener("mousemove", e => { if(!drawing) return; ctx.beginPath(); ctx.moveTo(lastX,lastY); ctx.lineTo(e.offsetX,e.offsetY); ctx.stroke(); [lastX,lastY]=[e.offsetX,e.offsetY]; });
canvas.addEventListener("mouseup", ()=>{ drawing=false; saveSignature(); });
canvas.addEventListener("mouseout", ()=>{ drawing=false; saveSignature(); });

canvas.addEventListener("touchstart", e=>{ e.preventDefault(); drawing=true; const rect=canvas.getBoundingClientRect(); lastX=e.touches[0].clientX-rect.left; lastY=e.touches[0].clientY-rect.top; });
canvas.addEventListener("touchmove", e=>{ e.preventDefault(); if(!drawing) return; const rect=canvas.getBoundingClientRect(); const x=e.touches[0].clientX-rect.left; const y=e.touches[0].clientY-rect.top; ctx.beginPath(); ctx.moveTo(lastX,lastY); ctx.lineTo(x,y); ctx.stroke(); [lastX,lastY]=[x,y]; });
canvas.addEventListener("touchend", ()=>{ drawing=false; saveSignature(); });

function saveSignature(){ hiddenInput.value=canvas.toDataURL("image/png"); }

resetBtn.addEventListener("click", ()=>{ ctx.clearRect(0,0,canvas.width,canvas.height); hiddenInput.value=""; checkForm(); });

function checkForm(){
    const requiredFields = ["Vorname","Nachname","strasse","plz","ort","geburtsdatum","notfallnummer"];
    let ok=true; requiredFields.forEach(f=>{if(!document.getElementById(f).value.trim()) ok=false;});
    if(ok && document.querySelector("#dsgvo").checked && hiddenInput.value.trim()!==""){
        submitBtn.disabled=false; submitBtn.style.background="#7ccc00";
    } else { submitBtn.disabled=true; submitBtn.style.background="#aaa"; }
}

document.addEventListener("input", checkForm);
document.getElementById("dsgvo").addEventListener("change", checkForm);
document.getElementById("reset-btn").addEventListener("click", checkForm);
</script>

</body>
</html>
